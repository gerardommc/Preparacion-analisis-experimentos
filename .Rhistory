boxplot(uptake ~ Treatment, df.2)
boxplot(uptake ~ Type, df.2)
boxplot(uptake ~ Treatment + Type, df.2)
library(ggplot2)
ggplot(CO2) + geom_point(aes(x =  conc, y = uptake, colour = Type)) +
facet_wrap(~Treatment)
table(df.1$P)
table(df.1$K)
df.1
boxplot(yield ~ P + K, df.1)
df.1 <- subset(npk, N == 1, select = c("yield", "P", "K"))
df.1
npk
write.csv(df.1, "Unidad 3-ANOVA II/NPK.csv")
m1 <- aov(yield ~ N * K, df.1)
m1 <- aov(yield ~ P * K, df.1)
anova(m1)
m1 <- aov(yield ~ P + K, df.1)
anova(m1)
m1 <- aov(yield ~ K, df.1)
anova(m1)
car :: Anova(m1, type = 2)
m1 <- aov(yield ~ P + K, df.1)
car :: Anova(m1, type = 2)
m1 <- aov(yield ~ P * K, df.1)
car :: Anova(m1, type = 2)
m1 <- aov(yield ~ K * P, df.1)
car :: Anova(m1, type = 2)
plot(m1)
m1 <- kruskal.test(yield ~ K * P, df.1)
df.2
boxplot(uptake ~ Treatment + Type, df.2)
df.2
df.2 <- subset(CO2, select = c("Treatment", "Type", "uptake")
df.2 <- subset(CO2, select = c("Treatment", "Type", "uptake"))
df.2
write.csv(df.2, "Unidad 3-ANOVA II/CO2.csv")
m2 <- aov(uptake ~ Treatment + Type, df.2)
m2
summary(m2)
m2 <- aov(uptake ~ Treatment * Type, df.2)
summary(m2)
df.2
df.2 <- df.2[c(sample(1:40, 24), sample(41:80, 36))]
df.2 <- df.2[c(sample(1:40, 24), sample(41:80, 36)), ]
df.2
table(df.2$Treatment)
table(df.2$Type)
write.csv(df.2, "Unidad 3-ANOVA II/CO2.csv")
m2 <- aov(uptake ~ Treatment * Type, df.2)
summary(m2)
car::Anova(m2, type =2)
plot(m2)
m2 <- aov(uptake ~ Treatment + Type, df.2)
summary(m2)
plot(m2)
boxplot(uptake ~ Treatment + Type, df.2)
boxplot(uptake ~ Type, df.2)
lme4::Arabidopsis
head(lme4::Arabidopsis)
knitr::opts_chunk$set(echo = TRUE)
library(lme4)
data(Arabidopsis)
summary(Arabidopsis[,"total.fruits"])
table(gsub("[0-9].","",levels(Arabidopsis[,"popu"])))
library(lattice)
stripplot(log(total.fruits+1) ~ amd|nutrient, data = Arabidopsis,
groups = gen,
strip=strip.custom(strip.names=c(TRUE,TRUE)),
type=c('p','a'), ## points and panel-average value --
## see ?panel.xyplot
scales=list(x=list(rot=90)),
main="Panel: nutrient, Color: genotype")
summary(Arabidopsis[,"total.fruits"])
table(gsub("[0-9].","",levels(Arabidopsis[,"popu"])))
library(lattice)
stripplot(log(total.fruits+1) ~ amd|nutrient, data = Arabidopsis,
groups = gen,
strip=strip.custom(strip.names=c(TRUE,TRUE)),
type=c('p','a'), ## points and panel-average value --
## see ?panel.xyplot
scales=list(x=list(rot=90)),
main="Panel: nutrient, Color: genotype")
?Arabidopsis
data()
CO2
npk
npk.1 <- subset(npk, select = c("block", "P", "K", "yield"))
boxplot(log(yield) ~ P + K, npk.1)
m1 <- lmer(yield ~ P + K, npk.1)
resids <- residuals(m2)
pressure
antibio
data(antibio)
knitr::opts_chunk$set(echo = TRUE)
data(npk)
m1 <- lm(yield ~ N * P, data = npk)
m2 <- lm(yield ~ N * K, data = npk)
m3 <- lm(yield ~ P * K, data = npk)
car::Anova(m1, m2, m3, type = 2)
m5 <- lmer(yield ~ N + K + (1|block), data = npk)
df.1 <- subset(npk, N == 1, select = c("yield", "P", "K"))
table(df.1$P)
table(df.1$K)
df.1$yield
NA
df.2 <- na.omit(df.1)
df.2
m1 <- aov(yield ~ K * P, df.1)
car :: Anova(m1, type = 2)
m2 <- aov(yield ~ K + P, df.1)
car :: Anova(m2, type = 2)
m3 <- aov(yield ~ K, df.1)
car :: Anova(m3, type = 2)
nrow(df.1)
library(ggplot2)
ggplot(CO2) + geom_point(aes(x =  conc, y = uptake, colour = Type)) +
facet_wrap(~Treatment)
ggplot(CO2) + geom_point(aes(x =  conc, y = uptake, colour = Type)) +
geom_smooth(aes(x = conc, y = uptake, colour = Type), alpha = 0.5) +
facet_wrap(~Treatment)
df.2 <- subset(CO2, select = c("Treatment", "Type", "uptake"))
df.2 <- df.2[c(sample(1:40, 24), sample(41:80, 36)), ]
m2 <- aov(uptake ~ Treatment + Type, df.2)
summary(m2)
boxplot(uptake ~ Treatment + Type, df.2)
df.2 <- read.csv( "Unidad 3-ANOVA II/CO2.csv")
table(df.2$Treatment)
table(df.2$Type)
m2 <- aov(uptake ~ Treatment * Type, df.2)
summary(m2)
car::Anova(m2, type =2)
plot(m2)
m2 <- aov(uptake ~ Treatment + Type, df.2)
car::Anova(m2, type =2)
plot(m2)
coef(m2)
knitr::opts_chunk$set(echo = TRUE)
data(npk)
npk
data()
chichwts
chickwts
volcano
ToothGrowth
LifeCycleSavings
weightloss
install.packages("datarium")
knitr::opts_chunk$set(echo = TRUE)
colesterol <- datarium::heartattack
x1 <- rnorm(20, 0, 1)
x2 <- rnorm(20, 1, 1.5)
df <- data.frame(x = c(x1, x2), y = rep(c("A", "B"), each = 20))
df.1 <- data.frame(x = c(x1, x2), y = rep(c("A", "B"), each = 20))
aov(x ~ 1 + Error(1/y), df.1)
mean(df.1$x)
lme4:lmer(x ~ 1 + (1|y), df.1)
lme4::lmer(x ~ 1 + (1|y), df.1)
df.1 <- datarium::anxiety
df.1
df.1 <- datarium::jobsatisfaction
df.1
tail(df.1)
df.1 <- datarium::depression
df.1
data()
InsectSprays
CO2
df.1 <- CO2
conc.f <- df.1$conc
table(conc.f)
conc.f <- as.factor(df.1$conc)
conc.f
levels(conc.f) <- c("A", "A", "B", "B", "C", "C", "C")
conc.f
df.1$conc.factor <- conc.f
df.1 <- df.1[df.1$conc< 1000, ]
df.1
boxplot(uptake ~ conc.factor + Treatment, df.1)
library(ggplot2)
df.1 <- subset(df.1, select = c("uptake", "conc.factor", "Treatment", "Type"))
names(df.1)
df.1 <- CO2
conc.f <- as.factor(df.1$conc)
levels(conc.f) <- c("Baja", "Baja", "Media", "Media", "Alta", "Alta", "Alta")
df.1$conc.factor <- conc.f
df.1 <- df.1[df.1$conc< 1000, ]
df.1 <- subset(df.1, select = c("uptake", "conc.factor", "Treatment", "Type"))
names(df.1) <- c("Captura", "Concentraci贸n", "Tratamiento", "Ciudad")
ggplot(df.1) + geom_violin(aes(x = Concentraci贸n, y = Captura, colour = Tratamiento, fill = Tratamiento), alpha = 0.5)
ggplot(df.1) + geom_boxplot(aes(x = Concentraci贸n, y = Captura, colour = Tratamiento, fill = Tratamiento), alpha = 0.5)
m1 <- lme4::lmer(Captura ~ Concentraci贸n * Tratamiento + (1|Ciudad), df.1)
m1
car::Anova(m1, type = 3)
plot( m1)
car::Anova(m1, type = 2)
write.csv(df.1, "Unidad 3-ANOVA II/CO2-2.csv")
install.packages("tidyverse")
install.packages(c("rstatix", "ggpubr"))
knitr::opts_chunk$set(echo = TRUE)
colesterol <- datarium::heartattack
knitr::kable(head(colesterol))
knitr::kable(tail(colesterol))
tabla.combn <- expand.grid( #Creando la tabla de combinaciones
gender = c("male", "female"),
risk = c("low", "high"),
drug = c("A", "B", "C")
)
knitr::kable(tabla.combn, caption = "Tabla de combinaciones de tratamientos de `heartattack`")
boxplot(cholesterol ~ gender + risk + drug, colesterol)
library(tidyverse)
colesterol %>%
group_by(gender, risk, drug) %>%
shapiro.test(cholesterol)
library(tidyverse); library(rstatix)
colesterol %>%
group_by(gender, risk, drug) %>%
shapiro_test(cholesterol)
m1 <- lm(cholesterol ~ gender * risk * drug, data = colesterol)
car::Anova(m1, type = 1)
m1 <- lm(cholesterol ~ gender * risk * drug, data = colesterol)
anova(m1)
m2 <- lm(cholesterol ~ gender + risk + drug + gender:drug + risk:drug + gender : risk : drug, data = colesterol)
anova(m1, m2)
AIC(m1)
AIC(m2)
coefficients(m3)
m3 <- lm(cholesterol ~ 0 + gender * risk * drug, colesterol)
summary(m3)
coefficients(m3)
length(coefficients(m3))
perf <- datarium::performance
print(perf)
perf.l <- reshape::melt(perf)
perf.l <- reshape2::melt(perf, id.vars = "id")
perf.l
perf.l <- reshape2::melt(perf, id.vars = c("t1", "t2"))
perf.l
perf
perf.l <- reshape2::melt(perf, id.vars = c("id", "gender", "stress"))
perf.l
names(perf.l) <- c("id", "genero", "estres", "tiempo", "score")
names(perf.l) <- c("id", "genero", "estres", "tiempo", "desempeno")
write.csv(perf.l, "Unidad 3-ANOVA 2/Performance.csv")
getwd()
write.csv(perf.l, "Unidad 3-ANOVA II/Performance.csv")
library(ggplot2)
ggplot(perf.l) + geom_violin(aes(x = genero, y = desempeno, colour = tiempo, fill = tiempo),
alpha = 0.5) +
geom_boxplot(aes(x = genero, y = desempeno, colour = tiempo, fill = tiempo),
alpha = 0.5)
library(lme4)
m1 <- lmer(desempeno ~ genero * tiempo + (1|id), perf.l)
summary(m1)
car::Anova(m1, type = 2)
datarium::heartattack
perf <- datarium::headache
headache <- datarium::headache
headache
ggplot(headache) + geom_violin(aes(x = treatment, y = pain_score, colour = risk, fill = risk),
alpha = 0.5) +
facet_wrap(~gender)
ggplot(headache) + geom_violin(aes(x = treatment, y = pain_score, colour = risk, fill = risk),
alpha = 0.5) +
geom_boxplot(aes(x = treatment, y = pain_score, colour = risk, fill = risk),
alpha = 0.5) +
facet_wrap(~gender)
m1 <- lm(pain_score ~ treatment * risk * gender, headache)
summary(m1)
car::Anova(m1, type = 2)
plot(m1)
knitr::opts_chunk$set(echo = TRUE)
df.1 <- expand.grid(x, y, fert = fert)
x <- c(1:3)
y <- 1:2
fert <- LETTERS[1:3]
df.1 <- expand.grid(x, y, fert = fert)
df.1
x <- c(1:3)
y <- 1:2
df.1 <- expand.grid(x, y)
nrow(df.1)
x <- c(1:3)
y <- 1:2
df.1 <- expand.grid(x, y)
df.1$Suelo <- rep(LETTERS[1:3], 2)
library(ggplot2)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo))
df.1 <- expand.grid(x, y)
df.1$Suelo <- rep(LETTERS[1:3], 2)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo))
df.1
df.1$Suelo <- rep(LETTERS[1:3], each = 2)
library(ggplot2)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo))
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = factor(Suelo)))
x <- c(1:3)
y <- 1:2
df.1 <- expand.grid(x, y)
df.1$Suelo <- rep(LETTERS[1:3], each = 2)
library(ggplot2)
ggplot(df.1) + geom_raster(aes(x = x, y = y, fill = Suelo))
rm(x)
rm(y)
3/6
3/9
source("../Random-functions/Shuffle.R")
df.1 <- expand.grid(x = 1:3, y = 1:2)
df.1$Suelo <- rep(LETTERS[1:3], 2)[shuffle(6)]
x.fert <- seq(0.33, 3-0.33, len= 9)
y.fert <- c(1,2)
library(ggplot2)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo))
x.fert <- seq(0.25, 3.25, len = 6)
x.fert
xy.fert <- expand.grid(x = x.fert, y = y.fert)
nrow(xy.fert)
xy.fert$Fertilizante <- rep(LETTERS[1:2], 6)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, labels = Fertilizante), data = xy.fert)
xy.fert <- expand.grid(x = x.fert, y = y.fert)
xy.fert$Fertilizante <- rep(LETTERS[1:2], 6)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, labels = Fertilizante), data = xy.fert)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, label = Fertilizante), data = xy.fert)
xy.fert
x.fert <- seq(0.25, 3.25, len = 6)
y.fert <- c(1,2)
xy.fert <- expand.grid(x = x.fert, y = y.fert)
xy.fert$Fertilizante <- rep(LETTERS[1:2], 6)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, label = Fertilizante), data = xy.fert)
xy.fert
source("../Random-functions/Shuffle.R")
df.1 <- expand.grid(x = 1:3, y = 1:2)
df.1$Suelo <- rep(LETTERS[1:3], 2)
x.fert <- seq(0.25, 3.25, len = 6)
y.fert <- c(1,2)
xy.fert <- expand.grid(x = x.fert, y = y.fert)
xy.fert$Fertilizante <- rep(LETTERS[1:2], 6)
library(ggplot2)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, label = Fertilizante), data = xy.fert)
x.fert <- c(0.75, 1.25, 1.75, 2.25, 2.75, 3.25)
y.fert <- c(1,2)
xy.fert <- expand.grid(x = x.fert, y = y.fert)
xy.fert$Fertilizante <- rep(LETTERS[1:2], 6)
ggplot(df.1) + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, label = Fertilizante), data = xy.fert)
xy.fert
source("../Random-functions/Shuffle.R")
df.1 <- expand.grid(x = 1:3, y = 1:2)
df.1$Suelo <- rep(LETTERS[1:3], 2)
x.fert <- c(0.75, 1.25, 1.75, 2.25, 2.75, 3.25)
y.fert <- c(1,2)
xy.fert <- expand.grid(x = x.fert, y = y.fert)
xy.fert$Fertilizante <- rep(LETTERS[1:2], 6)
library(ggplot2)
ggplot() + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, label = Fertilizante), data = xy.fert)
source("../Random-functions/Shuffle.R")
df.1 <- expand.grid(x = 1:3, y = 1:2)
df.1$Suelo <- rep(LETTERS[1:3], 2)
x.fert <- c(0.75, 1.25, 1.75, 2.25, 2.75, 3.25)
y.fert <- c(1,2)
xy.fert <- expand.grid(x = x.fert, y = y.fert)
xy.fert$Fertilizante <- rep(LETTERS[3:4], 6)
library(ggplot2)
ggplot() + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, label = Fertilizante), data = xy.fert)
source("../Random-functions/Shuffle.R")
df.1 <- expand.grid(x = 1:3, y = 1:2)
df.1$Suelo <- rep(LETTERS[1:3], 2)
x.fert <- c(0.75, 1.25, 1.75, 2.25, 2.75, 3.25)
y.fert <- c(1,2)
xy.fert <- expand.grid(x = x.fert, y = y.fert)
xy.fert$Fertilizante <- rep(LETTERS[4:5], 6)
library(ggplot2)
ggplot() + geom_tile(aes(x = x, y = y, fill = Suelo), data = df.1) +
geom_text(aes(x = y, y = y, label = Fertilizante), data = xy.fert)
knitr::opts_chunk$set(echo = TRUE)
auto.1l <- reshape2::melt(auto.1)
auto.1 <- datarium::selfesteem
knitr::kable(auto.1, caption = "Base de datos `selfesteem`", align = "c")
auto.1l <- reshape2::melt(auto.1)
auto.1l
auto.1l <- reshape2::melt(auto.1, id.vars = "id")
auto.1l
auto <- datarium::selfesteem2
auto.l <- reshape2::melt(auto, id.vars = c("id", "treatment"))
names(auto.l) <- c("id", "tratamiento", "tiempo", "auto")
auto.l
library(lme4)
m1 <- lmer(auto ~ tiempo * tratamiento + (1|id), auto.l)
car:Anova(m1, type = 2)
library(lme4)
m1 <- lmer(auto ~ tiempo * tratamiento + (1|id), auto.l)
car::Anova(m1, type = 2)
library(lme4)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id/(tratamiento + tiempo)), auto.l)
car::Anova(m1, type = 2)
library(lme4)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id/(tratamiento + tiempo)), auto.l)
summary(m1)
library(lme4)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id/(tiempo + tratamiento)), auto.l)
summary(m1)
library(lme4)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id), auto.l)
summary(m1)
library(lme4)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id/(tiempo + tratamiento)), auto.l)
summary(m1)
knitr::opts_chunk$set(echo = TRUE)
auto <- datarium::selfesteem2
auto.l <- reshape2::melt(auto, id.vars = c("id", "treatment"))
names(auto.l) <- c("id", "tratamiento", "tiempo", "auto")
library(lme4)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id/(tiempo + tratamiento)), auto.l)
summary(m1)
library(lme4)
m2 <- lmer(auto ~ tiempo * tratamiento + ((tiempo + tratamiento)|id), auto.l)
car::Anova(m2, type = 2)
library(lme4)
m2 <- lmer(auto ~ tiempo * tratamiento + (1|id), auto.l)
car::Anova(m2, type = 2)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id/(tiempo * tratamiento)), auto.l)
summary(m1)
library(lme4)
m2 <- lmer(auto ~ tiempo * tratamiento + ((tiempo * tratamiento)|id), auto.l)
library(lme4)
m2 <- lmer(auto ~ tiempo * tratamiento + ((tiempo : tratamiento)|id), auto.l)
library(lme4)
m2 <- lmer(auto ~ tiempo * tratamiento + ((tiempo + tratamiento)|id), auto.l)
car::Anova(m2, type = 2)
m1 <- aov(auto ~ tiempo * tratamiento + Error(id/(tiempo * tratamiento)), auto.l)
summary(m1)
m2 <- aov(auto ~ tiempo * tratamiento, auto.l)
summary(m2)
library(lme4)
m2 <- lmer(auto ~ tiempo * tratamiento + ((tiempo + tratamiento)|id), auto.l)
car::Anova(m2, type = 2)
m1 <- aov(auto ~ tiempo * tratamiento, auto.l)
summary(m1)
m2 <- aov(auto ~ tiempo * tratamiento + Error(id/(tiempo * tratamiento)), auto.l)
summary(m2)
data()
PlantGrowth
Theoph
library(ggplot2)
dat <- Theoph
names(dat)
ggplot(dat) + geom_point(aes(x = Time, y = conc, colour = as.factor(Wt))) +
geom_line(aes(x = Time, y = conc, colour = as.factor(Wt))) +
facet_wrap(~Dose)
ggplot(dat) + geom_point(aes(x = Time, y = conc)) +
geom_smooth(aes(x = Time, y = conc))
ggplot(dat) + geom_point(aes(x = Time, y = conc, colour = Dose)) +
geom_smooth(aes(x = Time, y = conc, colour = Dose))
ggplot(dat) + geom_point(aes(x = Time, y = conc, colour = Dose)) +
geom_smooth(aes(x = Time, y = conc, colour = Dose), method = "gam")
dat <- cars
names(cars)
ggplot(dat) + geom_point(aes(x = speed, y = dist)) +
geom_smooth(aes(x = speed, y = dist), method = "lm")
nrow(cars)
knitr::opts_chunk$set(echo = TRUE)
data(cars)
data(cars)
m1 <- lm(dist ~ speed, cars)
summary(m1)
knitr::opts_chunk$set(echo = TRUE)
perdida <- datarium::weightloss()
perdida <- datarium::weightloss
head(perdida)
weight.l <- reshape2::melt(weight, id.vars = c("id", "diet", "exercises"))
weight <- datarium::weightloss
knitr::kable(head(weight))
weight.l <- reshape2::melt(weight, id.vars = c("id", "diet", "exercises"))
knitr::kable(head(weight.l))
weight
View(weight)
boxplot(loss(loss ~ (diet + exercises)/time, weight.l))
m1 <- aov(loss ~ (diet * exercises)/time + Error(id/(diet * exercises)/time), weight.l)
weight.l <- reshape2::melt(weight, id.vars = c("id", "diet", "exercises"))
names(weight.l) <- c("id", "diet", "exercises", "time", "loss")
knitr::kable(head(weight.l)) #Imprimiendo las primeras seis filas de la tabla resultante
library(tidyverse); library(rstatix)
shap.test <- weight.l %>%
group_by(diet, exercises, time) %>%
shapiro_test(loss)
knitr::kable(shap.test, caption = "Resultados de la prueba de Shapiro dentro de cada grupo experimental.", align = "c")
m1 <- aov(loss ~ (diet * exercises)/time + Error(id/(diet * exercises)/time), weight.l)
summary(m1)
library(lme4)
m1 <- lmer(loss ~ (diet * exercises)/time + (1|id/(diet * exercises)/time), weight.l)
library(lme4)
m1 <- lmer(loss ~ (diet * exercises)/time + (1|id|(diet * exercises)|time), weight.l)
library(lme4)
m1 <- lmer(loss ~ (diet * exercises)/time + (1|id), weight.l)
summary(m1)
library(lme4)
m1 <- lmer(loss ~ (diet * exercises)/time + (1|id), weight.l)
car::Anova(m1, type = 2)
library(lme4)
m1 <- lmer(loss ~ (diet * exercises)/time + (1|id/(diet * exercises)), weight.l)
library(lme4)
m1 <- lmer(loss ~ (diet * exercises)/time + (1|id/(diet + exercises)), weight.l)
library(lme4)
m1 <- lmer(loss ~ (diet * exercises)/time + (1|id/(diet)), weight.l)
car::Anova(m1, type = 2)
