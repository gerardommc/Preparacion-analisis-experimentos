modelo.1 <- aov(formula = Valores ~ Tratamiento, data = base.datos)
modelo.1
qf(0.05, 14, 30)
summary(modelo.1)
set.seed(123)
y1 <- rnorm(15, mean = 10, sd = 2)
y2 <- rnorm(15, mean = 7, sd = 3)
y3 <- rnorm(15, mean = 15, sd = 4)
y <- c(y1, y2, y3)
tratamientos <- rep(c("A", "B", "C"), each = 15)
base.datos <- data.frame(Tratamiento = tratamientos,
Valores = y)
head(base.datos)
tail(base.datos)
modelo.1 <- aov(formula = Valores ~ Tratamiento, data = base.datos)
modelo.1
746.5761/2
358.7810/42
373.288/8.542405
qf(0.05, 14, 30)
summary(modelo.1)
df.1 <- read.csv("Datos-tarea.csv")
m.1 <- aov(Valor ~ Tratamiento, df.1)
summary(m1)
summary(m.11)
summary(m.1)
m.1 <- lm(Valor ~ Tratamiento, df.1)
summary(m.1)
m.1
anoca(m.1)
anova(m.1)
m.1 <- aov(Valor ~ Tratamiento, df.1)
summary(m.1)
m.1
boxplot(Valor ~ Tratamiento, df.1)
install.packages("klippy")
data <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Datos-ejercicio-1.xlsx")
names(data)
data.l <- reshape::melt(data)
data.l
names(data.l)
m1 <- aov(value ~ variable, data = data.l)
summary(m1)
nrow(data.l)
qf(0.05, 3, 117)
data <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Datos-ejercicio-2.xlsx")
data
names(data)
m2 <- aov(Valor ~ Tratamiento, data = data)
summary(m2)
head(data)
qf(0.05, 3, 117)
summary(m2)
qf(0.05, 3, 117)
data <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Base-datos-Aleatorios.xlsx")
m1 <- aov(Valor ~ Tratamiento + Error(Tratamiento/Bloque), data = data)
summary(m1)
m1 <- aov(Valor ~ Tratamiento + Error(Bloque), data = data)
summary(m1)
boxplot(Valor ~ Tratamiento, data = data)
m1 <- aov(Valor ~ Tratamiento + Error(Tratamiento/Bloque), data = data)
m1
m1 <- aov(Valor ~ Tratamiento + Error(Bloque), data = data)
summary(m1)
data <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Base-datos-Aleatorios.xlsx")
m1 <- aov(Valor ~ Tratamiento + Error(Bloque), data = data)
summary(m1)
m2 <- aov(Valor ~ Tratamiento, data = data)
summary(m2)
m1 <- aov(Valor ~ Tratamiento + Error(Bloque/Tratamiento), data = data)
summary(m1)
m1 <- aov(Valor ~ Tratamiento + Error(Bloque/Tratamiento), data = data)
summary(m1)
m2 <- aov(Valor ~ Tratamiento, data = data)
summary(m2)
anova(m2)
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("Unidad 1-Introducción/Fertilizante-cuadrado.png")
exp(2)
set.seed(123)
y1 <- rnorm(100, mean = 0, sd = 2)
y2 <- rnorm(100, mean = 0, sd = 0.5)
tabla.1 <- data.frame(y = c(y1, y2),
x = rep(c("A", "B"), each = 100))
boxplot(y ~ x, data = tabla.1)
y1 <- rnorm(100, mean = 0, sd = 2)
y2 <- rnorm(100, mean = 10, sd = 0.5)
tabla.1 <- data.frame(y = c(y1, y2),
x = rep(c("A", "B"), each = 100))
boxplot(y ~ x, data = tabla.1)
boxplot(y, data = tabla.1)
y1 <- rnorm(100, mean = 0, sd = 2)
y2 <- rnorm(100, mean = 10, sd = 0.5)
tabla.1 <- data.frame(y = c(y1, y2),
x = rep(c("A", "B"), each = 100))
boxplot(y, data = tabla.1)
y1 <- rnorm(100, mean = 0, sd = 2)
y2 <- rnorm(100, mean = 10, sd = 0.5)
tabla.1 <- data.frame(y = c(y1, y2),
x = rep(c("A", "B"), each = 100))
plot(density(talba.1$y))
plot(density(tabla.1$y))
boxplot(tabla.1$y)
plot(density(tabla.1$y))
shpairo.test(y1)
y1 <- rnorm(100, mean = 0, sd = 2)
y2 <- rnorm(100, mean = 10, sd = 0.5)
shpairo.test(y1)
shapiro.test(y1)
shapiro.test(y2)
boxplo(y~x, tabla.1)
boxplot(y~x, tabla.1)
points(c(1, 2), c(mean(y1), mean(y2)), col="red", pch = 20, cex = 1.5)
y.lnorm <- exp(rnorm(100, mean = 0, sd = 1))
media.lnorm <- mean(y.lnorm)
boxplot(y.lnorm)
points(1, media.lnorm, col = "red", pch = 20, cex = 1.5)
shapiro.test(y.lnorm)
set.seed(123)
y1 <- rnorm(15, mean = 10, sd = 2)
y2 <- rnorm(15, mean = 7, sd = 3)
y3 <- rnorm(15, mean = 15, sd = 4)
y <- c(y1, y2, y3)
tratamientos <- rep(c("A", "B", "C"), each = 15)
base.datos <- data.frame(Tratamiento = tratamientos,
Valores = y)
boxplot(Valores ~ Tratamiento, base.datos)
points(c(1, 2, 3),
c(mean(y1), mean(y2), mean(y3)),
col = "red", pch = 20, cex = 1.5)
shapiro.test(y1)
shapiro.test(y2)
shapiro.test(y3)
modelo.1 <- aov(Valores ~ Tratamiento, base.datos)
modelo.2 <- lm(Valores ~ Tratamiento, base.datos)
summary(modelo.1)
summary(modelo.2)
anova(modelo.2)
summary(modelo.2)
10.3048-4.0445
10.3048+5.8764
plot(modelo.2)
##
datos.2 <- base.datos
datos.2 <- exp(datos.2$Valores)
boxplot(Valores ~ Tratamiento, datos.2)
head(datos.2)
##
datos.2 <- base.datos
datos.2$Valores <- exp(datos.2$Valores)
boxplot(Valores ~ Tratamiento, datos.2)
##
y <- c(rpois(10, 1),
rpois(10, 2),
rpois(10, 4))
trats <- rep(c("A", "B", "C"), each = 10)
datos.2 <- data.frame(Valores = y, Tratamiento = trats)
boxplot(Valores ~ Tratamiento, datos.2)
modelo.3 <- aov(Valores ~ Tratamiento, datos.2)
summary(modelo.3)
plot(modelo.3)
shapiro.test(y1)
shapiro.test(exp(y1))
shapiro.test(y2)
summary(modelo.2)
knitr::opts_chunk$set(echo = TRUE)
datos.completos <- sapply(medias.trat, function(x){rnorm(25, mean = x, sd = runif(1, 0, 1.5))})
#Experimento antibióticos
antib <- letters[1:10]
medias.trat <- c(round(runif(10, min = 2, max = 20), 1))
datos.completos <- sapply(medias.trat, function(x){rnorm(25, mean = x, sd = runif(1, 0, 1.5))})
datos.completos <- round(datos.completos, 1)
datos.completos[which(datos.completos < 0)] <- 0
datos.completos
plot(density(datos.completos))
#Experimento antibióticos
antib <- rep(letters[1:10], each = 25)
Caja <- rep(1:50, 5)[shuffle(250)]
source("../Random-functions/Shuffle.R")
Caja <- rep(1:50, 5)[shuffle(250)]
#Experimento antibióticos
antib <- rep(letters[1:10], each = 25)
medias.trat <- c(round(runif(10, min = 2, max = 20), 1))
datos.completos <- sapply(medias.trat, function(x){rnorm(25, mean = x, sd = runif(1, 0, 1.5))})
datos.completos <- round(datos.completos, 1)
datos.completos[which(datos.completos < 0)] <- 0
source("../Random-functions/Shuffle.R")
Caja <- rep(1:50, 5)[shuffle(250)]
base.antib <- data.frame(Radio = datos.completos,
Antibiótico = antib,
Caja = Caja)
base.antib
base.antib
boxplot(Radio~Antibiótico, base.antib)
names(base.antib)
datos.completos
base.antib <- data.frame(Radio = datos.completos[],
Antibiótico = antib,
Caja = Caja)
boxplot(Radio~Antibiótico, base.antib)
datos.completos[]
base.antib <- data.frame(Radio = c(datos.completos),
Antibiótico = antib,
Caja = Caja)
head(base.antib)
boxplot(Radio~Antibiótico, base.antib)
boxplot(Radio~Caja, base.antib)
boxplot(Radio~Caja + Antibiótico, base.antib)
set.seed(234)
spp <- letters[2:4]
tamaño <- exp(c(rnorm(50, mean = 2, sd = 2), rnorm(50, mean = 2, sd = 1), rnorm(50, mean = 0, sd = 2)))
base.mangle <- data.frame(Especie = rep(spp, ech = 50),
Tamaño = tamaño)
write.csv(base.mangle, "Base-mangle.csv")
boxplot(Tamaño~Especie, base.mangle)
kruskal.test(Tamaño~Especie, base.mangle)
aov(Tamaño~Especie, base.mangle)
summary(aov(Tamaño~Especie, base.mangle))
set.seed(234)
spp <- letters[2:4]
tamaño <- exp(c(rnorm(50, mean = 2, sd = 2), rnorm(50, mean = 2.5, sd = 1), rnorm(50, mean = 0, sd = 2)))
base.mangle <- data.frame(Especie = rep(spp, ech = 50),
Tamaño = tamaño)
kruskal.test(Tamaño~Especie, base.mangle)
summary(aov(Tamaño~Especie, base.mangle))
tamaño <- exp(c(rnorm(50, mean = 2, sd = 2), rnorm(50, mean = 3, sd = 1), rnorm(50, mean = 0, sd = 2)))
base.mangle <- data.frame(Especie = rep(spp, ech = 50),
Tamaño = tamaño)
kruskal.test(Tamaño~Especie, base.mangle)
summary(aov(Tamaño~Especie, base.mangle))
tamaño <- exp(c(rnorm(50, mean = 1.5, sd = 2), rnorm(50, mean = 3, sd = 1), rnorm(50, mean = 0, sd = 2)))
base.mangle <- data.frame(Especie = rep(spp, ech = 50),
Tamaño = tamaño)
kruskal.test(Tamaño~Especie, base.mangle)
summary(aov(Tamaño~Especie, base.mangle))
tamaño <- exp(c(rnorm(50, mean = 1.5, sd = 2), rnorm(50, mean = 3.1, sd = 1), rnorm(50, mean = 0, sd = 2)))
base.mangle <- data.frame(Especie = rep(spp, ech = 50),
Tamaño = tamaño)
kruskal.test(Tamaño~Especie, base.mangle)
summary(aov(Tamaño~Especie, base.mangle))
set.seed(234)
spp <- letters[2:4]
tamaño <- exp(c(rnorm(50, mean = 1.5, sd = 2), rnorm(50, mean = 3.1, sd = 1), rnorm(50, mean = 0, sd = 2)))
base.mangle <- data.frame(Especie = rep(spp, ech = 50),
Tamaño = tamaño)
kruskal.test(Tamaño~Especie, base.mangle)
summary(aov(Tamaño~Especie, base.mangle))
boxplot(Tamaño~Especie, base.mangle)
#Experimento antibióticos
antib <- rep(letters[1:10], each = 25)
medias.trat <- c(round(runif(10, min = 2, max = 20), 1))
datos.completos <- sapply(medias.trat, function(x){rnorm(25, mean = x, sd = runif(1, 0, 1.5))})
datos.completos <- round(datos.completos, 1)
datos.completos[which(datos.completos < 0)] <- 0
source("../Random-functions/Shuffle.R")
Caja <- rep(1:50, 5)[shuffle(250)]
base.antib <- data.frame(Radio = c(datos.completos),
Antibiótico = antib,
Caja = Caja)
library(lmer)
library(lme4)
m <- lmer(Radio~Antibiótico + (1|Caja), base.antib)
base.antib <- data.frame(Radio = c(datos.completos),
Antibiótico = antib,
Caja = as.factor(Caja))
m <- lmer(Radio~Antibiótico + (1|Caja), base.antib)
summary(m)
m2 <- lm(Radio~Antibiótico, base.antib)
summary(m2)
plot(m2)
m2 <- aov(Radio~Antibiótico + Error(Caja/Antibiótico), base.antib)
View(base.antib)
knitr::opts_chunk$set(echo = TRUE)
fert <- LETTERS[1:2]
herb <- letters[1:2]
comb <- expand.grid(Fertilizante = fert,
Herbicida =herb)
knitr::kable(comb)
cars
chickwts
names(chickwts)
boxplot(weight ~ feed, chickwts)
precip
sleep
ldeaths
matplot(ldeaths)
matplot(t(ldeaths), type = "l")
matplot(t(ldeaths))
matplot(as.matrix(ldeaths))
fdeaths
mdeaths
knitr::opts_chunk$set(echo = TRUE)
h <- mdeaths
m <- fdeaths
h.largo <- reshape::melt(mdeaths)
m.largo <- reshape::melt(fdeaths)
h.largo$Sexo <- "Hombres"
m.largo$Sexo <- "Mujeres"
h.largo
m.largo
h <- mdeaths
m <- fdeaths
h <- rowSums(h)
h
class(h)
as.matrix(h)
typeof(h)
h <- matrix(mdeaths, ncol = 12, byrow = T)
m <- matrix(fdeaths, ncol = 12, byrow = T)
h
mdeaths
h <- rowSums(h)
m <- rowSums(m)
h
m
h
h <- mdeaths
m <- fdeaths
h.largo <- reshape::melt(mdeaths)
m.largo <- reshape::melt(fdeaths)
h.largo$Sexo <- "Hombres"
m.largo$Sexo <- "Mujeres"
h.largo
ToothGrowth
knitr::opts_chunk$set(echo = TRUE)
datos.2 <- ToothGrowth
datos.2$dose <- as.factor(paste0("D", datos.2$dose))
datos.2[datos.2$supp == "OJ" & datos.2$dose == "D1.0", ] <- NA
datos.2[datos.2$supp == "VC" & datos.2$dose == "D2.0", ] <- NA
datos.2 <- na.omit(datos.2)
datos.2 <- ToothGrowth
datos.2$dose <- as.factor(paste0("D", datos.2$dose))
datos.2[datos.2$supp == "OJ" & datos.2$dose == "D1.0", ] <- NA
datos.2[datos.2$supp == "VC" & datos.2$dose == "D2.0", ] <- NA
datos.2 <- na.omit(datos.2)
datos.2
datos.2 <- ToothGrowth
datos.2$dose <- as.factor(paste0("D", datos.2$dose))
datos.2[datos.2$supp == "OJ" & datos.2$dose == "D1", ] <- NA
datos.2[datos.2$supp == "VC" & datos.2$dose == "D2", ] <- NA
datos.2 <- ToothGrowth
datos.2$dose <- as.factor(paste0("D", datos.2$dose))
datos.2[datos.2$supp == "OJ" & datos.2$dose == "D1", ] <- 0
datos.2[datos.2$supp == "VC" & datos.2$dose == "D2", ] <- 0
datos.2 <- ToothGrowth
datos.2$dose <- as.factor(paste0("D", datos.2$dose))
datos.2[datos.2$supp == "OJ" & datos.2$dose == "D1", ] <- 0
datos.2$supp == "OJ"
datos.2 <- ToothGrowth
knitr::opts_chunk$set(echo = TRUE)
plot(anova(modelo.3))
data()
InsectSprays
Orange
Puromycin
UScitiesD
airquality
cars
faithful
freeny
occupationalStatus
sleep
swiss
women
warpbreaks
names(warpbreaks)
boxplot(warpbreaks~wool+tension, data = warpbreaks)
boxplot(breaks~wool+tension, data = warpbreaks)
mtcars
datos <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Datos-ejercicio-1.xlsx")
names(datos)
datos.l <- reshape::melt(datos)
datos.l
m1 <- aov(value ~ variable, daos.l)
m1 <- aov(value ~ variable, datos.l)
sumary(m1)
summary(m1)
datos <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Datos-ejercicio-2.xlsx")
names(datos)
m1 <- aov(Valor ~ Tratamiento, datos)
summary(m1)
datos <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Datos-ejercicio-1.xlsx")
nrow(datos)
ncol(datos)
qf(0.05, 3, 116)
qf(0.05, 29, 120-30)
datos <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Datos-ejercicio-2.xlsx")
table(datos$Tratamiento)
datos <- openxlsx::read.xlsx("Unidad 2-ANOVA I/Base-datos-Aleatorios.xlsx")
datos
m1 <- aov(Valor ~ Tratamiento, datos)
summary(m1)
m1 <- aov(Valor ~ Tratamiento + Error(Bloque/Tratamienti), datos)
m1 <- aov(Valor ~ Tratamiento + Error(Bloque/Tratamiento), datos)
summary(m1)
90/6
x = 1:9
y = 1:10
source("Random-functions/Shuffle.R")
cols = rep(letters[1:3], 10)[shuffle(90)]
df.1 <- expand.grid(x = x, y = y)
nrow(df.1)
cols = rep(letters[1:3], 30)[shuffle(90)]
df.1 <- expand.grid(x = x, y = y)
df.1$trat <- cols
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat))
library(ggplot2)
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat))
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat), size = 2)
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat), size = 2) +
labs(colour = "Tipo de suelo")+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
)
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat), size = 2) +
labs(colour = "Tipo de suelo")+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
)
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat), size = 2) +
labs(colour = "Tipo de suelo", x = "", y = "")+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
)
pdf("Palmas.pdf", width = 5, height = 4)
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat), size = 2) +
labs(colour = "Tipo de suelo", x = "", y = "")+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
)
dev.off()
pdf("Examen I/Palmas.pdf", width = 5, height = 4)
ggplot(df.1) + geom_point(aes(x = x, y = y, colour = trat), size = 2) +
labs(colour = "Tipo de suelo", x = "", y = "")+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
)
dev.off()
medias <- ceiling(runif(6, 1, 4))
medias
datos <- sapply(medias, function(x){rnorm(15, x, runif(1, 1, 2))})
trats <- rep(letters[1:6], each = 15)
datos.2 <- sapply(medias, function(x){rnorm(15, x  + runif(1, -1, 1), runif(1, 1, 2))})
bloq <- rep(c("a", "b"), each = length(datos.1))
set.seed(15453)
medias <- ceiling(runif(6, 1, 4))
datos.1 <- sapply(medias, function(x){rnorm(15, x, runif(1, 1, 2))})
datos.2 <- sapply(medias, function(x){rnorm(15, x  + runif(1, -1, 1), runif(1, 1, 2))})
datos.1
datos.1 <- c(sapply(medias, function(x){rnorm(15, x, runif(1, 1, 2))}))
datos.1
set.seed(15453)
medias <- ceiling(runif(6, 1, 4))
datos.1 <- c(sapply(medias, function(x){rnorm(15, x, runif(1, 1, 2))}))
datos.2 <- c(sapply(medias, function(x){rnorm(15, x  + runif(1, -1, 1), runif(1, 1, 2))}))
trats <- rep(letters[1:6], each = 15)
bloq <- rep(c("a", "b"), each = length(datos.1))
trats <- rep(rep(letters[1:6], each = 15), 2)
trats
df.2 <- data.frame(Valor = c(datos.1, datos.2), Tratamiento = trats
Bloque = bloq)
df.2 <- data.frame(Valor = c(datos.1, datos.2), Tratamiento = trats,
Bloque = bloq)
boxplot(Valor ~ Tratamiento, df.2)
boxplot(Valor ~ Tratamiento + Bloque, df.2)
trats <- rep(rep(LETTERS[1:6], each = 15), 2)
bloq <- rep(c("a", "b"), each = length(datos.1))
df.2 <- data.frame(Valor = c(datos.1, datos.2), Tratamiento = trats,
Bloque = bloq)
boxplot(Valor ~ Tratamiento + Bloque, df.2)
summary(aov(Valor~Tratamiento, df.2))
summary(aov(Valor~Tratamiento + Error(Bloque/Tratamiento), df.2))
plot(aov(Valor~Tratamiento, df.2))
plot(aov(Valor~Tratamiento + Error(Bloque/Tratamiento), df.2))
kruskal.test(Valor~Tratamiento, df.2)
write.csv(df.2, "Examen I/Base-1.csv")
meds <- ceiling(runif(4, 1 3))
datos <- c(sapply(meds, function(x){rpois(10, x + runif(1, -0.5, 1))}))
meds <- ceiling(runif(4, 1, 3))
datos <- c(sapply(meds, function(x){rpois(10, x + runif(1, -0.5, 1))}))
datos
trats1 <- rep(LETTES[1:4], each = 10)
trats1 <- rep(LETTERS[1:4], each = 10)
boxplot(datos ~ trats1)
kruskal.test(datos~trats1)
summary(aov(datos~trats1))
meds <- ceiling(runif(4, 1, 5))
datos <- c(sapply(meds, function(x){rpois(10, x + runif(1, -0.5, 1))}))
trats1 <- rep(LETTERS[1:4], each = 10)
boxplot(datos ~ trats1)
summary(aov(datos~trats1))
kruskal.test(datos~trats1)
plot(aov(datos~trats1))
datos <- c(sapply(meds, function(x){exp(rnorm(10, x,  runif(1, 0.1, 1)))}))
trats1 <- rep(LETTERS[1:4], each = 10)
boxplot(datos ~ trats1)
kruskal.test(datos~trats1)
plot(aov(datos~trats1))
write.csv(df.3, "Examen I/Base-2.csv")
df.3 <- data.frame(Valor = datos, Tratamiento = trats1)
write.csv(df.3, "Examen I/Base-2.csv")
write.csv(df.2, "Examen I/Base-1.csv", row.names = F)
write.csv(df.3, "Examen I/Base-2.csv", row.names = F)
